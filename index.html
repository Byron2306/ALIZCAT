<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,user-scalable=yes" />
  <title>ALIZA'S REVENGE</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<!-- ================= TITLE / BOOT ================= -->
<div class="overlay" id="title" onclick="begin()">
  <div class="box titleBox">
    <div class="titleWrap">
      <div class="titleText">
<pre class="ascii grad">
╔══════════════════════════════════════════╗
║            A L I Z A ' S                 ║
║              R E V E N G E               ║
║     DEFENSE SIM → FIGHT TO SURVIVE       ║
║        TAP ANYWHERE TO START             ║
╚══════════════════════════════════════════╝
</pre>
        <div class="tap blink">TAP ANYWHERE TO START</div>
        <div class="tap subtle" id="bootStatus">(awaiting input)</div>
        <div class="tap subtle small">rotate to landscape for combat · pinch zoom enabled</div>
      </div>

      <!-- pixel portrait -->
      <canvas id="portrait" width="128" height="128"></canvas>
    </div>
  </div>
</div>

<!-- ================= AGENT POPUP ================= -->
<div class="agentWrap" id="agentWrap">
  <div class="agentBox">
    <canvas class="agentSprite" id="agentSprite" width="56" height="56"></canvas>
    <div class="agentText">
      <div class="agentHead">
        <span>AGENT // VOX</span>
        <span id="agentStage">ALERT</span>
      </div>
      <div class="agentLine" id="agentLine">…</div>
    </div>
  </div>
</div>

<!-- ================= GLITCH BANNER ================= -->
<div class="bannerWrap" id="bannerWrap">
  <div class="banner" id="bannerText">FIGHT TO SURVIVE</div>
</div>

<!-- ================= COMPROMISED ================= -->
<div class="compWrap" id="compWrap">
  <div class="compCenter">
    <div>
      <div class="compText" id="compText">YOU'VE BEEN COMPROMISED!</div>
      <div class="compSub">SYSTEM GLYPH CORRUPTION // RESET REQUIRED</div>
      <button class="startBtn" onclick="resetRun()">RESET RUN</button>
    </div>
  </div>
</div>

<!-- ================= CONSOLE ================= -->
<div class="overlay consoleOverlay" id="console" style="display:none">
  <div class="box consoleBox" id="consoleBox">

    <div class="topRow">
      <div class="badge">DEFENSE SIM // 3 VECTORS</div>
      <div class="timer" id="timer">TIME LEFT: 05:00</div>
      <div class="badge danger">FAIL: -05s</div>
      <div class="badge ok" id="progress">0 / 3 MITIGATED</div>
    </div>

    <div class="layout">

      <!-- ========== LEFT: TERMINALS ========== -->
      <div class="stack">

        <!-- VECTOR 1 -->
        <section class="card termA" id="card1">
          <header class="cardHead">
            <h3>Vector 01 — Packet Reassembly</h3>
            <div class="tag">decode + rebuild</div>
          </header>
          <div class="mono typewriter" id="p1data"></div>
          <div class="row">
            <input id="p1in" autocomplete="off" placeholder="enter reconstructed phrase…" />
            <button id="p1go">VERIFY</button>
          </div>
          <div class="msg" id="p1msg"></div>
        </section>

        <!-- VECTOR 2 -->
        <section class="card termB" id="card2">
          <header class="cardHead">
            <h3>Vector 02 — Log Triage</h3>
            <div class="tag amber">filter + extract</div>
          </header>
          <div class="mono artifact" id="p2data"></div>
          <div class="row">
            <input id="p2in" autocomplete="off" placeholder="enter extracted key…" />
            <button id="p2go">VERIFY</button>
          </div>
          <div class="msg" id="p2msg"></div>
        </section>

        <!-- VECTOR 3 -->
        <section class="card termC" id="card3">
          <header class="cardHead">
            <h3>Vector 03 — Integrity Gate</h3>
            <div class="tag magenta">checksum logic</div>
          </header>
          <div class="mono glitch" id="p3data"></div>
          <div class="row">
            <input id="p3in" autocomplete="off" placeholder="enter exact phrase…" />
            <button id="p3go">VERIFY</button>
          </div>
          <div class="msg" id="p3msg"></div>
        </section>

      </div>

      <!-- ========== RIGHT: TOOLS ========== -->
      <aside class="tools" id="tools">

        <div class="toolsTop">
          <div class="toolsTitle">Tools // Assistant Panel</div>
          <button class="toolsToggle" id="toolsToggle">Collapse</button>
        </div>

        <div class="tabs">
          <button class="tab active" data-tab="decoder">Decoder</button>
          <button class="tab" data-tab="triage">Triage</button>
          <button class="tab" data-tab="checksum">Checksum</button>
        </div>

        <!-- DECODER -->
        <div class="toolPane active" id="tab-decoder">
          <div class="tiny">
            Reassemble the payload. One transformation is reversed.
          </div>
          <div class="toolRow">
            <button id="dSort">Sort</button>
            <button id="dJoin">Join</button>
            <button id="dB64">Base64</button>
            <button id="dReverse">Reverse</button>
            <button id="dUpper">UPPERCASE</button>
          </div>
          <textarea class="toolOut" id="dOut"></textarea>
          <div class="tiny subtle" id="dStats">—</div>
        </div>

        <!-- TRIAGE -->
        <div class="toolPane" id="tab-triage">
          <div class="tiny">Filter logs until one survives.</div>
          <div class="toolRow">
            <label class="chip"><input type="checkbox" id="tHigh" checked> HIGH</label>
            <label class="chip"><input type="checkbox" id="tNeon" checked> sig=NEON</label>
            <label class="chip"><input type="checkbox" id="tBlock" checked> rule=BLOCK</label>
          </div>
          <input class="toolIn" id="tQuery" placeholder="search terms…" />
          <div class="toolRow">
            <button id="tScan">Scan</button>
            <button id="tExtract">Extract</button>
            <button id="tClear">Reset</button>
          </div>
          <textarea class="toolOut" id="tOut"></textarea>
          <div class="tiny subtle" id="tStats">Matches: —</div>
        </div>

        <!-- CHECKSUM -->
        <div class="toolPane" id="tab-checksum">
          <div class="tiny">
            checksum(text) = sum(ASCII) mod 97
          </div>
          <input class="toolIn" id="cIn" placeholder="type phrase…" />
          <div class="toolRow">
            <button id="cCalc">Compute</button>
            <button id="cTryA">Try A</button>
            <button id="cTryB">Try B</button>
            <button id="cTryC">Try C</button>
            <button id="cTryD">Try D</button>
          </div>
          <textarea class="toolOut" id="cOut"></textarea>
        </div>

      </aside>
    </div>

    <div class="footerNote subtle">
      Incorrect answers trigger an alarm, red flash, and -05 seconds.
    </div>

  </div>
</div>

<!-- ================= FIGHT HUD ================= -->
<div class="fightHUD" id="fightHUD">
  <div class="hudRow">
    <div class="hpPanel">
      <div class="hpName">ALIZA</div>
      <div class="hpBar"><div class="hpFill" id="hpAliza"></div></div>
    </div>
    <div class="roundPanel" id="roundPanel">ROUND 1</div>
    <div class="hpPanel right">
      <div class="hpName">AGENT</div>
      <div class="hpBar"><div class="hpFill agent" id="hpAgent"></div></div>
    </div>
  </div>
  <div class="hudHint" id="hudHint">← → move · ↓ duck · Z/X punch · A/S kick</div>
</div>

<!-- ================= MOBILE CONTROLS ================= -->
<div class="mobileControls" id="mobileControls">
  <div class="mLeft">
    <button class="mBtn" data-act="left">◀</button>
    <button class="mBtn" data-act="right">▶</button>
    <button class="mBtn" data-act="duck">▼</button>
  </div>
  <div class="mRight">
    <button class="mBtn" data-act="lp">Z</button>
    <button class="mBtn" data-act="hp">X</button>
    <button class="mBtn" data-act="lk">A</button>
    <button class="mBtn" data-act="hk">S</button>
  </div>
</div>

<!-- ================= CANVAS ================= -->
<canvas id="game"></canvas>

<script src="game.js"></script>
</body>
</html>